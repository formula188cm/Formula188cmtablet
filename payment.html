<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Payment - Formula188cm</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="checkout.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

    <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-M9MMBPJ99L"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-M9MMBPJ99L');
</script>

    <!-- Meta Pixel Code -->
<script>
!function(f,b,e,v,n,t,s)
{if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};
if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];
s.parentNode.insertBefore(t,s)}(window, document,'script',
'https://connect.facebook.net/en_US/fbevents.js');
fbq('init', '1971818573593848');
fbq('track', 'PageView');
</script>
<noscript><img height="1" width="1" style="display:none"
src="https://www.facebook.com/tr?id=1971818573593848&ev=PageView&noscript=1"
/></noscript>
<!-- End Meta Pixel Code -->
</head>
<body>
    <header>
        <nav>
            <div class="logo">Formula188cm</div>
        </nav>
    </header>
    <main class="checkout-container">
        <div class="order-summary-top">
            <div class="summary-item">
                <span>Subtotal</span>
                <span id="subtotal">₹1,299.00</span>
            </div>
            <div class="summary-item">
                <span>Shipping</span>
                <span>Free</span>
            </div>
            <div class="summary-item total">
                <span>Total</span>
                <span id="total">₹1,299.00</span>
            </div>
        </div>
        <div class="checkout-content">
            <div class="payment-options">
                <h2>Select Payment Method</h2>
                <div class="payment-method" data-method="cod" id="cod-method" style="margin-bottom:18px;">
                    <label style="display:flex;align-items:center;gap:12px;cursor:pointer;font-size:1.08rem;">
                        <input type="radio" name="payment" value="cod" id="cod-radio" style="accent-color:#000;width:18px;height:18px;">
                        <i class="fas fa-money-bill-wave"></i>
                        <div class="payment-info">
                            <span class="payment-title">Cash on Delivery</span>
                            <span class="description" style="font-size:0.97rem;color:#555;">Pay when you receive the product</span>
                        </div>
                    </label>
                </div>
                <div class="payment-method" data-method="online" id="online-method">
                    <label style="display:flex;align-items:center;gap:12px;cursor:pointer;font-size:1.08rem;">
                        <input type="radio" name="payment" value="online" id="online-radio" style="accent-color:#000;width:18px;height:18px;">
                        <i class="fas fa-credit-card"></i>
                        <div class="payment-info">
                            <span class="payment-title">Pay Online</span>
                            <span class="description" style="font-size:0.97rem;color:#555;">Credit/Debit Card, UPI, Net Banking</span>
                        </div>
                    </label>
                    <div class="online-suboptions" id="online-suboptions" style="display:none;margin-top:18px;">
                        <div style="display:flex;flex-direction:column;gap:-5px;">
                            <label style="display:flex;align-items:center;gap:10px;font-size:1.08rem;">
                                <input type="radio" name="online-method" value="bank" id="bank-radio" style="accent-color:#000;width:18px;height:18px;">
                                <span>Bank Transfer</span>
                            </label>
                            <label style="display:flex;align-items:center;gap:10px;font-size:1.08rem;">
                                <input type="radio" name="online-method" value="upi" id="upi-radio" style="accent-color:#000;width:18px;height:18px;">
                                <span>UPI Transfer</span>
                            </label>
                            
                            <!-- UPI Apps Selection -->
                            <div id="upi-apps-section" style="display:none;margin:15px 0;padding:15px;background:#f8f9fa;border-radius:10px;border:1px solid #e9ecef;">
                                <h4 style="margin:0 0 15px 0;font-size:1.1rem;color:#333;">Choose your UPI App:</h4>
                                <div class="upi-apps-grid" style="display:grid;grid-template-columns:repeat(auto-fit,minmax(120px,1fr));gap:12px;">
                                    <button class="upi-app-btn" data-app="gpay" data-url="tez://upi/pay?pa=ayushyaduvanshi56441@okicici&pn=Ayush%20Kumar&am=1099&cu=INR" style="display:flex;flex-direction:column;align-items:center;justify-content:center;padding:15px 10px;background:#fff;border:2px solid #e9ecef;border-radius:10px;cursor:pointer;transition:all 0.3s ease;text-decoration:none;color:#333;font-size:0.9rem;font-weight:500;min-height:80px;">
                                        <i class="fab fa-google-pay" style="font-size:1.5rem;margin-bottom:8px;color:#4285f4;"></i>
                                        <span style="font-size:0.85rem;text-align:center;line-height:1.2;">Google Pay</span>
                                    </button>
                                    <button class="upi-app-btn" data-app="paytm" data-url="paytmmp://pay?pa=ayushyaduvanshi56441@okicici&pn=Ayush%20Kumar&am=1099&cu=INR" style="display:flex;flex-direction:column;align-items:center;justify-content:center;padding:15px 10px;background:#fff;border:2px solid #e9ecef;border-radius:10px;cursor:pointer;transition:all 0.3s ease;text-decoration:none;color:#333;font-size:0.9rem;font-weight:500;min-height:80px;">
                                        <i class="fas fa-mobile-alt" style="font-size:1.5rem;margin-bottom:8px;color:#00baf2;"></i>
                                        <span style="font-size:0.85rem;text-align:center;line-height:1.2;">Paytm</span>
                                    </button>
                                    <button class="upi-app-btn" data-app="bhim" data-url="bhim://upi/pay?pa=ayushyaduvanshi56441@okicici&pn=Ayush%20Kumar&am=1099&cu=INR" style="display:flex;flex-direction:column;align-items:center;justify-content:center;padding:15px 10px;background:#fff;border:2px solid #e9ecef;border-radius:10px;cursor:pointer;transition:all 0.3s ease;text-decoration:none;color:#333;font-size:0.9rem;font-weight:500;min-height:80px;">
                                        <i class="fas fa-university" style="font-size:1.5rem;margin-bottom:8px;color:#1e3a8a;"></i>
                                        <span style="font-size:0.85rem;text-align:center;line-height:1.2;">BHIM</span>
                                    </button>
                                    <button class="upi-app-btn" data-app="amazon" data-url="amazonpay://pay?pa=ayushyaduvanshi56441@okicici&pn=Ayush%20Kumar&am=1099&cu=INR" style="display:flex;flex-direction:column;align-items:center;justify-content:center;padding:15px 10px;background:#fff;border:2px solid #e9ecef;border-radius:10px;cursor:pointer;transition:all 0.3s ease;text-decoration:none;color:#333;font-size:0.9rem;font-weight:500;min-height:80px;">
                                        <i class="fab fa-amazon" style="font-size:1.5rem;margin-bottom:8px;color:#ff9900;"></i>
                                        <span style="font-size:0.85rem;text-align:center;line-height:1.2;">Amazon Pay</span>
                                    </button>
                                    <button class="upi-app-btn" data-app="mobikwik" data-url="mobikwik://pay?pa=ayushyaduvanshi56441@okicici&pn=Ayush%20Kumar&am=1099&cu=INR" style="display:flex;flex-direction:column;align-items:center;justify-content:center;padding:15px 10px;background:#fff;border:2px solid #e9ecef;border-radius:10px;cursor:pointer;transition:all 0.3s ease;text-decoration:none;color:#333;font-size:0.9rem;font-weight:500;min-height:80px;">
                                        <i class="fas fa-wallet" style="font-size:1.5rem;margin-bottom:8px;color:#ff6b35;"></i>
                                        <span style="font-size:0.85rem;text-align:center;line-height:1.2;">MobiKwik</span>
                                    </button>
                                    <button class="upi-app-btn" data-app="freecharge" data-url="freecharge://pay?pa=ayushyaduvanshi56441@okicici&pn=Ayush%20Kumar&am=1099&cu=INR" style="display:flex;flex-direction:column;align-items:center;justify-content:center;padding:15px 10px;background:#fff;border:2px solid #e9ecef;border-radius:10px;cursor:pointer;transition:all 0.3s ease;text-decoration:none;color:#333;font-size:0.9rem;font-weight:500;min-height:80px;">
                                        <i class="fas fa-bolt" style="font-size:1.5rem;margin-bottom:8px;color:#ff6b35;"></i>
                                        <span style="font-size:0.85rem;text-align:center;line-height:1.2;">Freecharge</span>
                                    </button>
                                    <button class="upi-app-btn" data-app="jupiter" data-url="jupiter://pay?pa=ayushyaduvanshi56441@okicici&pn=Ayush%20Kumar&am=1099&cu=INR" style="display:flex;flex-direction:column;align-items:center;justify-content:center;padding:15px 10px;background:#fff;border:2px solid #e9ecef;border-radius:10px;cursor:pointer;transition:all 0.3s ease;text-decoration:none;color:#333;font-size:0.9rem;font-weight:500;min-height:80px;">
                                        <i class="fas fa-rocket" style="font-size:1.5rem;margin-bottom:8px;color:#8b5cf6;"></i>
                                        <span style="font-size:0.85rem;text-align:center;line-height:1.2;">Jupiter</span>
                                    </button>
                                    <button class="upi-app-btn" data-app="cred" data-url="cred://pay?pa=ayushyaduvanshi56441@okicici&pn=Ayush%20Kumar&am=1099&cu=INR" style="display:flex;flex-direction:column;align-items:center;justify-content:center;padding:15px 10px;background:#fff;border:2px solid #e9ecef;border-radius:10px;cursor:pointer;transition:all 0.3s ease;text-decoration:none;color:#333;font-size:0.9rem;font-weight:500;min-height:80px;">
                                        <i class="fas fa-credit-card" style="font-size:1.5rem;margin-bottom:8px;color:#ff6b35;"></i>
                                        <span style="font-size:0.85rem;text-align:center;line-height:1.2;">CRED</span>
                                    </button>
                                </div>
                                <div style="margin-top:12px;font-size:0.95rem;color:#666;text-align:center;">
                                    <i class="fas fa-info-circle"></i> Click on your preferred UPI app to open it directly
                                </div>
                            </div>
                            
                            <div id="upi-ios-note" style="display:block;margin:2px 0 10px 0;font-size:0.97rem;color:#b00;width:100%;max-width:100%;">
                                <i class="fas fa-info-circle"></i> Note: UPI app links may not work on Apple/iOS devices. If you are using an iPhone, please use the QR code option.
                            </div>
                            <label style="display:flex;align-items:center;gap:10px;font-size:1.08rem;">
                                <input type="radio" name="online-method" value="qr" id="qr-radio" style="accent-color:#000;width:18px;height:18px;">
                                <span>QR Code</span>
                            </label>
                        </div>
                    </div>
                </div>
                <button id="proceed-payment" class="complete-order-btn" style="background:#000;color:#fff;margin-top:28px;display:block;width:100%;font-size:1.08rem;font-weight:600;">PROCEED PAYMENT</button>
            </div>
        </div>
    </main>
    <script>
    document.addEventListener('DOMContentLoaded', function() {
        const onlineRadio = document.getElementById('online-radio');
        const codRadio = document.getElementById('cod-radio');
        const suboptions = document.getElementById('online-suboptions');
        const proceedBtn = document.getElementById('proceed-payment');
        const paymentMethods = document.querySelectorAll('.payment-method');
        
        // Get the payment method from checkout page
        const orderDetails = JSON.parse(sessionStorage.getItem('orderDetails')) || {};
        const selectedPaymentMethod = orderDetails.paymentMethod || 'online';
        
        // Hide/show payment methods based on selection from checkout
        const codMethod = document.getElementById('cod-method');
        const onlineMethod = document.getElementById('online-method');
        
        if (selectedPaymentMethod === 'cod') {
            // Hide online payment option
            onlineMethod.style.display = 'none';
            // Auto-select COD
            codRadio.checked = true;
            codMethod.classList.add('selected');
        } else {
            // Hide COD option
            codMethod.style.display = 'none';
            // Auto-select online payment
            onlineRadio.checked = true;
            onlineMethod.classList.add('selected');
            // Show suboptions for online payment
            suboptions.style.display = 'block';
        }
        
        // Highlight main payment method
        function updateMainSelection() {
            paymentMethods.forEach(div => div.classList.remove('selected'));
            const selected = document.querySelector('input[name="payment"]:checked');
            if (selected) {
                selected.closest('.payment-method').classList.add('selected');
            }
        }
        
        document.querySelectorAll('input[name="payment"]').forEach(radio => {
            radio.addEventListener('change', function() {
                updateMainSelection();
                updatePrices();
                updateButtonText(); // Update button text on payment method change
            });
        });
        
        onlineRadio.addEventListener('change', function() {
            if (this.checked) {
                suboptions.style.display = 'block';
                suboptions.style.animation = 'fadeInSub 0.3s';
            }
        });
        codRadio.addEventListener('change', function() {
            suboptions.style.display = 'none';
        });
        
        // Highlight sub-option
        const subLabels = suboptions.querySelectorAll('label');
        function updateSubSelection() {
            subLabels.forEach(lab => lab.classList.remove('selected'));
            const selected = document.querySelector('input[name="online-method"]:checked');
            if (selected) {
                selected.closest('label').classList.add('selected');
            }
        }
        suboptions.querySelectorAll('input[name="online-method"]').forEach(radio => {
            radio.addEventListener('change', function() {
                updateSubSelection();
                
                // Show/hide UPI apps section
                const upiAppsSection = document.getElementById('upi-apps-section');
                if (this.value === 'upi') {
                    upiAppsSection.style.display = 'block';
                } else {
                    upiAppsSection.style.display = 'none';
                }
            });
        });
        
        // UPI App selection handling
        document.addEventListener('click', function(e) {
            if (e.target.classList.contains('upi-app-btn') || e.target.closest('.upi-app-btn')) {
                const btn = e.target.classList.contains('upi-app-btn') ? e.target : e.target.closest('.upi-app-btn');
                const appUrl = btn.getAttribute('data-url');
                const appName = btn.querySelector('span').textContent;
                
                // Try to open the UPI app
                try {
                    window.location.href = appUrl;
                    
                    // Show feedback to user
                    btn.style.background = '#e8f5e8';
                    btn.style.borderColor = '#28a745';
                    
                    // Reset after 2 seconds
                    setTimeout(() => {
                        btn.style.background = '#fff';
                        btn.style.borderColor = '#e9ecef';
                    }, 2000);
                    
                } catch (error) {
                    console.error('Error opening UPI app:', error);
                    alert(`Unable to open ${appName}. Please make sure the app is installed on your device.`);
                }
            }
        });

        // Initial highlight if pre-selected
        updateMainSelection();
        updateSubSelection();
        updateButtonText(); // Initial button text update
        
        proceedBtn.addEventListener('click', async function(e) {
            const selectedPayment = document.querySelector('input[name="payment"]:checked');
            if (!selectedPayment) {
                alert('Please select a payment method.');
                return;
            }
            
            if (selectedPayment.value === 'cod') {
                // COD flow: send to Sheet9
                const paymentDetails = {
                    method: 'cod',
                    orderStatus: 'confirmed',
                    timestamp: new Date().toLocaleString()
                };
                const codOrderData = {
                    ...orderDetails,
                    paymentMethod: 'cod',
                    orderStatus: 'confirmed',
                    paymentTimestamp: new Date().toLocaleString()
                };
                try {
                    await fetch('https://script.google.com/macros/s/AKfycbzLX07ZUl0JVEoknNUAb1KqURugPVE15UZTcTuGKyfz2urln5aN4xPqDH7HLFxPMagK/exec?sheet=Sheet9', {
                        method: 'POST',
                        mode: 'no-cors',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify(codOrderData)
                    });
                } catch (e) {}
                sessionStorage.setItem('paymentDetails', JSON.stringify(paymentDetails));
                window.location.href = 'thank-you.html';
                return;
            }
            
            // Online selected
            const selectedOnline = document.querySelector('input[name="online-method"]:checked');
            if (!selectedOnline) {
                alert('Please select Bank Transfer or UPI Transfer.');
                return;
            }
            
            // Send to Sheet7 for online payment (only orderDetails + paymentMethod)
            const onlineOrderData = {
                ...orderDetails,
                paymentMethod: 'online'
            };
            try {
                await fetch('https://script.google.com/macros/s/AKfycbzLX07ZUl0JVEoknNUAb1KqURugPVE15UZTcTuGKyfz2urln5aN4xPqDH7HLFxPMagK/exec?sheet=Sheet7', {
                    method: 'POST',
                    mode: 'no-cors',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(onlineOrderData)
                });
            } catch (e) {}
            
            if (selectedOnline.value === 'bank') {
                window.location.href = 'bank-transfer.html';
                return;
            }
            if (selectedOnline.value === 'upi') {
                // Show UPI apps section if not already visible
                const upiAppsSection = document.getElementById('upi-apps-section');
                if (upiAppsSection.style.display === 'none') {
                    upiAppsSection.style.display = 'block';
                }
                alert('Please select your preferred UPI app from the options below.');
                return;
            }
            if (selectedOnline.value === 'qr') {
                window.location.href = 'upi-transfer.html';
                return;
            }
        });
        
        // Function to update prices based on payment method
        function updatePrices() {
            const orderDetails = JSON.parse(sessionStorage.getItem('orderDetails'));
            const subtotalElement = document.getElementById('subtotal');
            const totalElement = document.getElementById('total');
            const basePrice = 1099;
            const codPrice = 1299;
            let quantity = 1;
            let paymentMethod = 'online';
            
            if (orderDetails) {
                quantity = parseInt(orderDetails.quantity) || 1;
            }
            
            // Get current selected payment method
            const selectedPayment = document.querySelector('input[name="payment"]:checked');
            if (selectedPayment) {
                paymentMethod = selectedPayment.value;
            }
            
            const pricePerUnit = paymentMethod === 'cod' ? codPrice : basePrice;
            const subtotal = pricePerUnit * quantity;
            subtotalElement.textContent = `₹${subtotal.toLocaleString()}.00`;
            totalElement.textContent = `₹${subtotal.toLocaleString()}.00`;
        }
        
        // Initial price update
        updatePrices();

        function updateButtonText() {
            const selectedPayment = document.querySelector('input[name="payment"]:checked');
            if (selectedPayment && selectedPayment.value === 'cod') {
                proceedBtn.textContent = 'CONFIRM ORDER';
            } else {
                proceedBtn.textContent = 'PROCEED PAYMENT';
            }
        }
        // Update button text on load and when payment method changes
        updateButtonText();
    });
    </script>
    <style>
    @keyframes fadeInSub {
        from { opacity: 0; transform: translateY(20px); }
        to { opacity: 1; transform: translateY(0); }
    }
    .online-suboptions { transition: all 0.3s; }
    .complete-order-btn { background:#000;color:#fff; }
    .payment-method { margin-bottom: 18px; }
    .payment-title { font-weight:600; }
    @media (max-width: 600px) {
        #upi-ios-note {
            font-size: 0.95rem;
            margin: 2px 0 8px 0;
            padding: 0 4px;
        }
    }
    @media (min-width: 601px) {
        #upi-ios-note {
            font-size: 1.01rem;
            margin: 2px 0 12px 0;
            padding: 0 8px;
        }
    }
    
    /* UPI App Button Hover Effects */
    .upi-app-btn:hover {
        border-color: #007bff !important;
        background: #f8f9ff !important;
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(0,123,255,0.15) !important;
    }
    
    /* Responsive grid for UPI apps */
    @media (max-width: 600px) {
        .upi-apps-grid {
            grid-template-columns: repeat(2, 1fr) !important;
            gap: 10px !important;
        }
        
        .upi-app-btn {
            padding: 12px 8px !important;
            min-height: 70px !important;
        }
        
        .upi-app-btn i {
            font-size: 1.3rem !important;
            margin-bottom: 6px !important;
        }
        
        .upi-app-btn span {
            font-size: 0.8rem !important;
        }
    }
    </style>
</body>
</html> 
